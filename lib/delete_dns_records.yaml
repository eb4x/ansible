---
- hosts: "{{ myhosts }}"

  tasks:
  - name: Delete A records
    shell: "echo -e 'server {{ ns_server }}\ndelete {{ item }} A\nsend' | nsupdate -k /etc/rndc-admin.key"
    loop: "{{ unwanted_a_records }}"
    when: unwanted_a_records is defined

  - name: Delete AAAA records
    shell: "echo -e 'server {{ ns_server }}\ndelete {{ item }} AAAA\nsend' | nsupdate -k /etc/rndc-admin.key"
    loop: "{{ unwanted_aaaa_records }}"
    when: unwanted_aaaa_records is defined

  - name: Delete CNAME records
    shell: "echo -e 'server {{ ns_server }}\ndelete {{ item }} CNAME\nsend' | nsupdate -k /etc/rndc-admin.key"
    loop: "{{ unwanted_cname_records }}"
    when: unwanted_cname_records is defined
